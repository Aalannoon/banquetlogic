<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Seniority Scheduler Dashboard</title>

<style>
body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  margin: 20px;
  background: #1e1e2f;
  color: #f0f0f0;
}
body.light-mode { background:#f8f9fa; color:#333; }

h1 { font-size:28px; margin-bottom:10px; }
h2 { margin-top:20px; margin-bottom:10px; }

/* TABS */
.tabs { display:flex; gap:6px; margin-bottom:12px; }
.tabs button {
  padding:8px 14px;
  border:none;
  border-radius:8px;
  font-weight:bold;
  cursor:pointer;
}
.tabs button.active { background:#4e9af1; color:#fff; }

/* INPUTS */
input, select, button {
  padding:6px 10px;
  border-radius:6px;
  border:none;
  margin:4px;
}
button { background:#4e9af1; color:#fff; font-weight:bold; }

/* TABLES */
table {
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th, td {
  padding:8px;
  text-align:center;
  border-bottom:1px solid #444;
}
th { background:#4e9af1; color:#fff; }

.employee-row td { border-top:3px solid #888; }

/* SHIFT COLORS */
.shift-4 { background:#2ecc71; }
.shift-6 { background:#e67e22; }
.shift-8 { background:#f1c40f; color:#000; }
.shift-ot { background:#9b59b6; }

/* STATUS */
.status-vacation { background:#7f8c8d; font-style:italic; }
.status-sick { background:#c0392b; font-style:italic; }

/* TABS */
.tab { display:none; }
.tab.active { display:block; }
</style>
</head>

<body>

<h1 id="weekHeader"></h1>
<button onclick="toggleDarkMode()">Toggle Dark Mode</button>

<div class="tabs">
  <button id="tabEmpBtn" onclick="showTab('employeesTab')">Employees</button>
  <button id="tabEvBtn" onclick="showTab('eventsTab')">Events</button>
  <button id="tabSchBtn" onclick="showTab('scheduleTab')">Schedule</button>
  <button onclick="window.print()">Export PDF</button>
</div>

<!-- EMPLOYEES -->
<div id="employeesTab" class="tab">
<h2>Employees</h2>

<input id="empName" placeholder="Name">
<select id="empType">
  <option value="FT">FT</option>
  <option value="PT">PT</option>
</select>
<input id="empSeniority" type="number" placeholder="Seniority">
<select id="empPref">
  <option value="">No Preference</option>
  <option value="AM">AM</option>
  <option value="PM">PM</option>
</select>
<button onclick="addEmployee()">Add</button>

<table>
<thead>
<tr>
<th>Name</th><th>Type</th><th>Seniority</th><th>Pref</th><th>Vac</th><th>Sick</th>
</tr>
</thead>
<tbody id="employeesTable"></tbody>
</table>
</div>

<!-- EVENTS -->
<div id="eventsTab" class="tab">
<h2>Events</h2>

<input id="eventName" placeholder="Event Name">

<select id="eventType">
  <option value="Plated Service">Plated Service</option>
  <option value="Buffet Service">Buffet Service</option>
  <option value="Reception">Reception</option>
  <option value="Coffee Break">Coffee Break</option>
</select>

<input id="eventDate" type="date">
<input id="eventStart" type="time">
<input id="eventEnd" type="time">
<input id="eventGuests" type="number" placeholder="Guests">
<input id="eventStaff" type="number" placeholder="Staff Needed">
<button onclick="addEvent()">Add Event</button>

<table>
<thead>
<tr>
<th>Name</th><th>Service</th><th>Date</th>
<th>Time</th><th>Guests</th>
<th>Rec.</th><th>Staff</th><th>Delete</th>
</tr>
</thead>
<tbody id="eventsTable"></tbody>
</table>
</div>

<!-- SCHEDULE -->
<div id="scheduleTab" class="tab">
<h2>Schedule</h2>
<button onclick="generateSchedule()">Generate</button>
<table id="scheduleTable"></table>
</div>

<script>
let employees = JSON.parse(localStorage.getItem("employees")||"[]");
let events = JSON.parse(localStorage.getItem("events")||"[]");

function save(){
  localStorage.setItem("employees",JSON.stringify(employees));
  localStorage.setItem("events",JSON.stringify(events));
}

function showTab(id){
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* EMPLOYEES */
function addEmployee(){
  employees.push({
    name:empName.value,
    type:empType.value,
    seniority:+empSeniority.value,
    pref:empPref.value,
    vacation:false,
    sick:false
  });
  save(); renderEmployees();
}
function renderEmployees(){
  employeesTable.innerHTML="";
  employees.sort((a,b)=>a.seniority-b.seniority).forEach((e,i)=>{
    employeesTable.innerHTML+=`
    <tr class="employee-row">
      <td>${e.name}</td>
      <td>${e.type}</td>
      <td>${e.seniority}</td>
      <td>${e.pref||"-"}</td>
      <td><input type="checkbox" ${e.vacation?"checked":""}
        onchange="employees[${i}].vacation=this.checked;save()"></td>
      <td><input type="checkbox" ${e.sick?"checked":""}
        onchange="employees[${i}].sick=this.checked;save()"></td>
    </tr>`;
  });
}

/* EVENTS */
function recommendedServers(type, guests){
  if(type==="Plated Service") return Math.ceil(guests/10);
  if(type==="Buffet Service") return Math.ceil(guests/20);
  if(type==="Reception") return Math.ceil(guests/25);
  if(type==="Coffee Break") return Math.ceil(guests/40);
  return 0;
}

function addEvent(){
  const start=new Date(`1970-01-01T${eventStart.value}`);
  const end=new Date(`1970-01-01T${eventEnd.value}`);
  let hours=(end-start)/36e5;
  if(hours>=6) hours+=0.5;

  const rec=recommendedServers(eventType.value,+eventGuests.value);

  events.push({
    name:eventName.value,
    type:eventType.value,
    date:eventDate.value,
    start:eventStart.value,
    end:eventEnd.value,
    hours,
    guests:+eventGuests.value,
    recommended:rec,
    staff:+eventStaff.value||rec
  });
  save(); renderEvents();
}

function renderEvents(){
  eventsTable.innerHTML="";
  events.forEach((e,i)=>{
    eventsTable.innerHTML+=`
    <tr>
      <td>${e.name}</td>
      <td>${e.type}</td>
      <td>${e.date}</td>
      <td>${e.start}–${e.end}</td>
      <td>${e.guests}</td>
      <td>${e.recommended}</td>
      <td><input type="number" value="${e.staff}"
        onchange="events[${i}].staff=+this.value;save()"></td>
      <td><button onclick="events.splice(${i},1);save();renderEvents()">X</button></td>
    </tr>`;
  });
}

/* SCHEDULE */
function generateSchedule(){
  scheduleTable.innerHTML="<tr><th>Employee</th><th>Shift</th></tr>";
  employees.sort((a,b)=>a.seniority-b.seniority).forEach(emp=>{
    const ev=events[0];
    if(!ev||emp.vacation||emp.sick) return;
    scheduleTable.innerHTML+=`
    <tr class="employee-row">
      <td>${emp.name}</td>
      <td class="shift-6">${ev.start}–${ev.end} (${ev.hours}h)</td>
    </tr>`;
  });
}

/* MODE */
function toggleDarkMode(){
  document.body.classList.toggle("light-mode");
}

/* INIT */
renderEmployees();
renderEvents();
showTab("employeesTab");
</script>

</body>
</html>
